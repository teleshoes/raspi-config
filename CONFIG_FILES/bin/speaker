#!/usr/bin/perl
use strict;
use warnings;

my $arg = shift;
if($arg eq "xbmc"){
  system "klomp-cmd", "stop";
  system "sudo", "initctl", "stop", "pulseaudio";
  system "sudo", "pkill", "-f", "/usr/bin/pulseaudio";
  system "sudo", "modprobe", "-r", "snd_bcm2835";
  system "sudo", "pkill", "-9", "-f", "klomp-lcd";
  system "lcd --off";
}elsif($arg eq "klomp"){
  system "fix-mount";
  system "sudo", "modprobe", "snd_bcm2835";
  system "sudo", "initctl", "stop", "pulseaudio";
  system "sudo", "pkill", "-f", "/usr/bin/pulseaudio";
  system "sudo", "pkill", "-9", "-f", "klomp-lcd";
  system "lcd --on";
  system "nohup klomp-lcd 1 >/dev/null 2>/dev/null &";
  system "klomp-cmd", "start";
}
